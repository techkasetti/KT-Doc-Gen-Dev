<!-- productionMonitoringDashboard.html -->
<template>
    <lightning-card title="Context-Aware Document Generator - Production Monitoring" icon-name="standard:dashboard">
        <div class="slds-p-horizontal_medium">
            
            <!-- Loading Spinner -->
            <template if:true={isLoading}>
                <lightning-spinner alternative-text="Loading system status..."></lightning-spinner>
            </template>

            <!-- Main Dashboard Content -->
            <template if:false={isLoading}>
                
                <!-- System Status Overview -->
                <div class="slds-grid slds-gutters slds-m-bottom_large">
                    <div class="slds-col slds-size_1-of-4">
                        <div class={statusClass}>
                            <lightning-icon icon-name="utility:success" size="medium" class="status-icon"></lightning-icon>
                            <div class="status-label">System Status</div>
                            <div class="status-value">{healthStatus.overallStatus}</div>
                        </div>
                    </div>
                    <div class="slds-col slds-size_1-of-4">
                        <div class="metric-card">
                            <lightning-icon icon-name="utility:clock" size="medium"></lightning-icon>
                            <div class="metric-label">Uptime</div>
                            <div class="metric-value">{uptimePercentage}%</div>
                        </div>
                    </div>
                    <div class="slds-col slds-size_1-of-4">
                        <div class="metric-card">
                            <lightning-icon icon-name="utility:error" size="medium"></lightning-icon>
                            <div class="metric-label">Error Rate</div>
                            <div class="metric-value">{healthStatus.errorRate}%</div>
                        </div>
                    </div>
                    <div class="slds-col slds-size_1-of-4">
                        <div class="metric-card">
                            <lightning-icon icon-name="utility:duration_downtime" size="medium"></lightning-icon>
                            <div class="metric-label">Avg Response</div>
                            <div class="metric-value">{healthStatus.averageResponseTime}s</div>
                        </div>
                    </div>
                </div>

                <!-- Generation Statistics -->
                <div class="slds-section slds-is-open slds-m-bottom_large">
                    <h3 class="slds-section__title slds-theme_shade">
                        <span class="slds-truncate slds-p-horizontal_small">
                            Generation Statistics (Last 24 Hours)
                        </span>
                    </h3>
                    <div class="slds-section__content">
                        <div class="slds-grid slds-gutters">
                            <div class="slds-col slds-size_1-of-3">
                                <div class="stat-card">
                                    <div class="stat-number">{healthStatus.totalGenerations}</div>
                                    <div class="stat-label">Total Generations</div>
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-3">
                                <div class="stat-card success">
                                    <div class="stat-number">{healthStatus.successfulGenerations}</div>
                                    <div class="stat-label">Successful</div>
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-3">
                                <div class="stat-card error">
                                    <div class="stat-number">{healthStatus.failedGenerations}</div>
                                    <div class="stat-label">Failed</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Component Health -->
                <div class="slds-section slds-is-open slds-m-bottom_large">
                    <h3 class="slds-section__title slds-theme_shade">
                        <span class="slds-truncate slds-p-horizontal_small">Component Health</span>
                    </h3>
                    <div class="slds-section__content">
                        <template for:each={healthStatus.componentHealth} for:item="component">
                            <div key={component.componentName} class="component-health-item slds-grid slds-gutters slds-m-bottom_small">
                                <div class="slds-col slds-size_1-of-3">
                                    <strong>{component.componentName}</strong>
                                </div>
                                <div class="slds-col slds-size_1-of-3">
                                    <span class={component.status}>{component.status}</span>
                                </div>
                                <div class="slds-col slds-size_1-of-3">
                                    <template if:true={component.responseTime}>
                                        Response Time: {component.responseTime}ms
                                    </template>
                                    <template if:false={component.responseTime}>
                                        Last Checked: {component.lastChecked}
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Active Alerts -->
                <div class="slds-section slds-is-open slds-m-bottom_large">
                    <h3 class="slds-section__title slds-theme_shade">
                        <span class="slds-truncate slds-p-horizontal_small">Active Alerts</span>
                    </h3>
                    <div class="slds-section__content">
                        <template if:true={healthStatus.activeAlerts}>
                            <template if:true={healthStatus.activeAlerts.length}>
                                <template for:each={healthStatus.activeAlerts} for:item="alert">
                                    <div key={alert.timestamp} class="alert-item slds-grid slds-gutters slds-m-bottom_small">
                                        <div class="slds-col slds-size_1-of-6">
                                            <lightning-badge label={alert.severity} variant={alert.severity} class="alert-severity"></lightning-badge>
                                        </div>
                                        <div class="slds-col slds-size_1-of-6">
                                            <strong>{alert.alertType}</strong>
                                        </div>
                                        <div class="slds-col slds-size_2-of-6">
                                            {alert.message}
                                        </div>
                                        <div class="slds-col slds-size_1-of-6">
                                            {alert.timestamp}
                                        </div>
                                        <div class="slds-col slds-size_1-of-6">
                                            <lightning-button
                                                label="Acknowledge"
                                                variant="brand-outline"
                                                size="small"
                                                data-alert-id={alert.alertId}
                                                onclick={handleAcknowledgeAlert}>
                                            </lightning-button>
                                        </div>
                                    </div>
                                </template>
                            </template>
                            <template if:false={healthStatus.activeAlerts.length}>
                                <p class="slds-text-color_weak">No active alerts</p>
                            </template>
                        </template>
                    </div>
                </div>

                <!-- Performance Metrics Chart -->
                <div class="slds-section slds-is-open slds-m-bottom_large">
                    <h3 class="slds-section__title slds-theme_shade">
                        <span class="slds-truncate slds-p-horizontal_small">Performance Trends</span>
                    </h3>
                    <div class="slds-section__content">
                        <div class="slds-grid slds-gutters slds-m-bottom_medium">
                            <div class="slds-col slds-size_1-of-2">
                                <lightning-combobox
                                    name="timeRange"
                                    label="Time Range"
                                    value={selectedTimeRange}
                                    placeholder="Select time range"
                                    options={timeRangeOptions}
                                    onchange={handleTimeRangeChange}>
                                </lightning-combobox>
                            </div>
                            <div class="slds-col slds-size_1-of-2 slds-text-align_right">
                                <lightning-button
                                    label="Generate Full Report"
                                    variant="brand"
                                    onclick={handleGenerateReport}>
                                </lightning-button>
                            </div>
                        </div>

                        <!-- Chart Container -->
                        <div class="chart-container">
                            <canvas class="performance-chart" height="300"></canvas>
                        </div>

                        <!-- Performance Data Table -->
                        <lightning-datatable
                            key-field="date"
                            data={performanceMetrics}
                            columns={performanceColumns}
                            hide-checkbox-column="true">
                        </lightning-datatable>
                    </div>
                </div>

                <!-- AI Model Status -->
                <div class="slds-section slds-is-open slds-m-bottom_large">
                    <h3 class="slds-section__title slds-theme_shade">
                        <span class="slds-truncate slds-p-horizontal_small">AI Model Status</span>
                    </h3>
                    <div class="slds-section__content">
                        <template if:true={healthStatus.aiModelStatus}>
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-4">
                                    <div class="ai-model-card">
                                        <div class="model-name">Context Analysis Model</div>
                                        <div class="model-status active">Active</div>
                                        <div class="model-confidence">Confidence: 94%</div>
                                    </div>
                                </div>
                                <div class="slds-col slds-size_1-of-4">
                                    <div class="ai-model-card">
                                        <div class="model-name">Clause Generation Model</div>
                                        <div class="model-status active">Active</div>
                                        <div class="model-confidence">Confidence: 91%</div>
                                    </div>
                                </div>
                                <div class="slds-col slds-size_1-of-4">
                                    <div class="ai-model-card">
                                        <div class="model-name">Compliance Checker</div>
                                        <div class="model-status active">Active</div>
                                        <div class="model-confidence">Confidence: 98%</div>
                                    </div>
                                </div>
                                <div class="slds-col slds-size_1-of-4">
                                    <div class="ai-model-card">
                                        <div class="model-name">Document Analyzer</div>
                                        <div class="model-status warning">Degraded</div>
                                        <div class="model-confidence">Confidence: 78%</div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- System Resources -->
                <div class="slds-section slds-is-open">
                    <h3 class="slds-section__title slds-theme_shade">
                        <span class="slds-truncate slds-p-horizontal_small">System Resources</span>
                    </h3>
                    <div class="slds-section__content">
                        <div class="slds-grid slds-gutters">
                            <div class="slds-col slds-size_1-of-3">
                                <div class="resource-card">
                                    <div class="resource-label">API Calls</div>
                                    <div class="resource-usage">
                                        <div class="usage-bar">
                                            <div class="usage-fill" style="width: 35%"></div>
                                        </div>
                                        <div class="usage-text">3,500 / 10,000</div>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-3">
                                <div class="resource-card">
                                    <div class="resource-label">Data Storage</div>
                                    <div class="resource-usage">
                                        <div class="usage-bar">
                                            <div class="usage-fill" style="width: 62%"></div>
                                        </div>
                                        <div class="usage-text">6.2 GB / 10 GB</div>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-col slds-size_1-of-3">
                                <div class="resource-card">
                                    <div class="resource-label">File Storage</div>
                                    <div class="resource-usage">
                                        <div class="usage-bar">
                                            <div class="usage-fill" style="width: 45%"></div>
                                        </div>
                                        <div class="usage-text">45 GB / 100 GB</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </template>
        </div>

        <!-- Health Report Modal -->
        <template if:true={showHealthReport}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close" onclick={handleCloseReport}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" size="small"></lightning-icon>
                        </button>
                        <h2 class="slds-text-heading_medium slds-hyphenate">System Health Report</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <div class="health-report-content">
                            <pre>{healthReport}</pre>
                        </div>
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning-button variant="brand" label="Download Report" onclick={handleDownloadReport}></lightning-button>
                        <lightning-button variant="neutral" label="Close" onclick={handleCloseReport}></lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
    </lightning-card>
</template>
